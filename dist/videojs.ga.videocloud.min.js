/*
* videojs-ga - v0.4.1 - 2014-12-02
* Copyright (c) 2014 Michael Bensoussan
* Licensed MIT
*/
(function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};videojs.plugin("ga",function(b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;null==b&&(b={}),console.log(7),w=this,c={},this.options()["data-setup"]&&(r=JSON.parse(this.options()["data-setup"]),r.ga&&(c=r.ga)),e=["playerLoad","loaded","percentsPlayed","start","end","seek","play","pause","resize","volumeChange","error","fullscreen"],l=b.eventsToTrack||c.eventsToTrack||e,u=b.percentsPlayedInterval||c.percentsPlayedInterval||10,i=b.eventCategory||c.eventCategory||"Brightcove Player",d=b.eventLabel||c.eventLabel,t=[],C=!1,g=!1,z=y=0,A=!1,j="",k={loadedmetadata:"Video Load","percent played":"Percent played",start:"Media Begin","seek start":"Seek start","seek end":"Seek end",play:"Media Play",pause:"Media Pause",error:"Error","exit fullscreen":"Fullscreen entered","enter fullscreen":"Fullscreen exited",resize:"Resize","volume change":"Volume Change","player load":"Player Load",end:"Media Complete"},n=function(a){return b.eventNames&&b.eventNames[a]?b.eventNames[a]:c.eventNames&&c.eventNames[a]?c.eventNames[a]:k[a]?k[a]:a},("players.brightcove.net"===window.location.host||"preview-players.brightcove.net"===window.location.host)&&(E=b.tracker||c.tracker,E&&(!function(a,b,c,d,e,f,g){return a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){return(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create",E,"auto"),ga("require","displayfeatures"))),q=function(){j=d?d:w.mediainfo?w.mediainfo.id+" | "+w.mediainfo.name:this.currentSrc().split("/").slice(-1)[0].replace(/\.(\w{3,4})(\?.*)?$/i,""),a.call(l,"loadedmetadata")>=0&&B(n("loadedmetadata"),!0)},D=function(){var b,c,d,e,f;for(b=Math.round(this.currentTime()),c=Math.round(this.duration()),e=Math.round(b/c*100),d=f=0;99>=f;d=f+=u)e>=d&&a.call(t,d)<0&&(a.call(l,"percentsPlayed")>=0&&0!==e&&B(n("percent played"),!0,d),e>0&&t.push(d));a.call(l,"seek")>=0&&(z=y,y=b,Math.abs(z-y)>1&&(A=!0,B(n("seek start"),!1,z),B(n("seek end"),!1,y)))},f=function(){g||(B("end",!0),g=!0)},v=function(){var b;b=Math.round(this.currentTime()),B(n("play"),!0,b),A=!1,a.call(l,"start")>=0&&!C&&(B(n("start"),!0),C=!0)},s=function(){var a,b;a=Math.round(this.currentTime()),b=Math.round(this.duration()),a===b||A||B(n("pause"),!1,a)},F=function(){var a;a=this.muted()===!0?0:this.volume(),B(n("volume change"),!1,a)},x=function(){B(n("resize")+" - "+this.width()+"*"+this.height(),!0)},h=function(){var a;a=Math.round(this.currentTime()),B(n("error"),!0,a)},m=function(){var a;a=Math.round(this.currentTime()),("function"==typeof this.isFullscreen?this.isFullscreen():void 0)||("function"==typeof this.isFullScreen?this.isFullScreen():void 0)?B(n("enter fullscreen"),!1,a):B(n("exit fullscreen"),!1,a)},B=function(a,b,c){window.ga?ga("send","event",{eventCategory:i,eventAction:a,eventLabel:j,eventValue:c,nonInteraction:b}):window._gaq?_gaq.push(["_trackEvent",i,a,j,c,b]):console.log("Google Analytics not detected")},a.call(l,"playerLoad")>=0&&(self!==top?(o=document.referrer+"(iframe)",p=1):(o=window.location.href,p=0),window.ga?ga("send","event",{eventCategory:i,eventAction:n("player load"),eventLabel:o,eventValue:p,nonInteraction:!1}):window._gaq?_gaq.push(["_trackEvent",i,n("player load"),o,p,!1]):console.log("Google Analytics not detected")),this.ready(function(){return this.on("loadedmetadata",q),this.on("timeupdate",D),a.call(l,"end")>=0&&this.on("ended",f),a.call(l,"play")>=0&&this.on("play",v),a.call(l,"pause")>=0&&this.on("pause",s),a.call(l,"volumeChange")>=0&&this.on("volumechange",F),a.call(l,"resize")>=0&&this.on("resize",x),a.call(l,"error")>=0&&this.on("error",h),a.call(l,"fullscreen")>=0?this.on("fullscreenchange",m):void 0})})}).call(this);